n=new Date,h=n.getHours(),$("title").html(21<h?"夜深了~":16<h?"晚上好!":13<h?"下午好!":10<h?"中午好!":7<h?"上午好!":4<h?"早上好!":"还不睡?")
var L=localStorage;
if(!L.mnu||JSON.parse(L.mnu)[0][1]<4)L.setItem('mnu',JSON.stringify([["dta",4],["logo","时间",1,1,"#44bbff","#44ffbb",36,0,120,"Google","logo/google.png"],["bg",1,"#888888","img/1.png",0,0,100,0.5,1,""],["bar",400,0,"What","Go","https://www.baidu.com/s?wd="],["book",0,"#000000",5]]))
if(!L.bok||L.bok=='[]')L.setItem('bok',JSON.stringify([["百度","https://m.baidu.com/?pu=sz%401321_480","img/baidu_5.png"],["谷歌","https://www.google.com.hk/?gws_rd=ssl","img/google_app.png"]]))
var B=JSON.parse(L.bok),C=JSON.parse(L.mnu),D=E=F=1,K='',i=/\.(png|jp(e?)g|gif)$/i,p=/[a-z]+:\/\//i,u=/[a-z0-9]+\./i
setInterval('n=new Date,h=n.getHours(),m=n.getMinutes(),s=n.getSeconds(),T&&$(".time").html((h<10?"0"+h:h)+":"+(m<10?0:K)+m+(s%2?":":" ")+(s<10?0:K)+s)')
for(var a=K,b=0;b<B.length;b++)a+='<li><div class="sc"></div><div class="bq" style="background-image:url('+B[b][2]+')" msg="'+B[b][1]+'"></div><p>'+B[b][0]+'</p></li>'
$('body').html('<div class="lgo time"></div><div class="custom"></div><div class="sx"></div><form id="menu"><div id="menus"><p>自定义HTML代码:</p><p style="height:auto"><textarea id="custom" style="height:50px" placeholder="未食用自定义  _(:з」∠)_"></textarea></p><hr/><p>点击切换logo样式: <o class="logo"></o></p><div class="logof"><input id="logof" type="text" placeholder="设置自定义文字"><p>设置字体颜色: <o class="fontc"></o><input id="fontc0" type="color" s><input id="fontc1" type="color" s></p><p>设置字体大小: <input id="fonts" type="text" onkeyup="num(this,2,0)" s>px</p><p class="timeb">是否开启暗显: <o></o></p></div><div id="logop"><p><input class="logop" placeholder="选择自定义logo文件" readonly p><input class="logop" type="text" placeholder="输入自定义logo路径" p><input type="file" id="pfile" accept="image/*" style="display:none"><o class="set"></o></p><p>设置图片圆角: <input id="logor" type="text" onkeyup="num(this,2,1)" s>px</p><p>设置图片宽度: <input id="logos" type="text" onkeyup="num(this,3,0)" s>px</p></div><hr/><p>点击切换背景样式: <o id="back"></o></p><p>点击切换页内刷新显隐性: <o class="qh"></o></p><p><input class="backp" placeholder="选择自定义背景文件" readonly p><input class="backp" type="text" placeholder="输入自定义背景路径" p><input type="file" id="bfile" accept="image/*" style="display:none"><o class="set"></o></p><p>T:<input type="text" id="backt" onkeyup="num(this,9,1)" s>px L:<input type="text" id="backl" onkeyup="num(this,9,1)" s>px W:<input type="text" id="backw" onkeyup="num(this,3,0)" s>% B:<input type="text" id="backb" onkeyup="num(this,3,1)" s>px</p><p>设置背景颜色: <input class="backc" type="color" s><input class="backc" type="text" onkeyup="num(this,16,1)" style="width:5em"></p><hr/><p>搜索框焦点获取时高度: <input type="text" id="barh" onkeyup="num(this,3,1)" s>px</p><p>搜索建议延时加载时长: <input type="text" id="bart" onkeyup="num(this,4,1)" s>ms</p><p>搜索输入框占位符:</p><p><input type="text" id="barp"></p><p>搜索提交按键占位符:</p><p><input type="text" id="bars"></p><hr/><p>设置书签单行个数: <input id="bookn" type="text" onkeyup="num(this,1,0)" s></p><p>设置书签标题颜色: <input id="bookc" type="color" s></p><p>设置书签图标圆角: <input id="bookr" type="text" onkeyup="num(this,2,1)" s>px</p><div id="about"><hr/><p>by <o>WQY916</o></p><p>and QQ: <o style="-webkit-user-select:text">3332802823</o></p><p>版本号: <o>4.0</o></p><o id="wqy">--- 原创动力 ---</o><div class="wqy"><p>是否恢复默认设置?(不包括书签)<div class="btn wyes">确定</div><div class="btn wno">取消</div></p></div></div></div><hr/><div id="menuo"><div class="btn about">关于</div><div class="btn myes">保存</div><div class="btn mno">取消</div></div></form><ul id="engine"><li msg="https://www.google.com.hk/search?q=">谷歌</li><li msg="https://www.baidu.com/s?wd=">百度</li><li msg="http://m.sm.cn/s?q=">神马</li><li msg="http://cn.bing.com/search?q=">必应</li><li msg="https://www.so.com/s?q=">好搜</li><li msg="https://www.sogou.com/web?query=">搜狗</li></ul><form id="bar"><ul id="suglist"></ul><input type="submit" id="submit"><div><o id="clear"></o></div><span><input type="text" id="input" autocomplete="off"></span></form><ul id="book">'+a+'<li class="mark"><div class="tj" style="background-image:url(img/mark.png)"></div><p>添加书签</p></li></ul><div id="bookmark"><div id="show"><div class="bbox"><p style="font-size:12px"></p><img class="bicon"><p class="btext"></p></div></div><form id="mark"><input class="ktext" type="text" placeholder="标题"><input class="khttp" type="text" placeholder="网址"><input class="kicon" placeholder="请选择图片文件" readonly p><input class="kicon" type="text" placeholder="请输入图片路径" p><input type="file" id="xfile" accept="image/*" style="display:none"><o class="set" style="top:8px"></o><div class="btn byes">确定</div><div class="btn bno">取消</div></form></div>')
$.fn.longPress=function(a){var b=void 0,c=this;for(d=c.length;d>0;d--)c[d-1].addEventListener('touchstart',function(){b=setTimeout(a,700)},!1),c[d-1].addEventListener('touchmove',function(){clearTimeout(b)},!1),c[d-1].addEventListener('touchend',function(){clearTimeout(b)},!1)}
$('#wqy').longPress('$(".wqy").slideDown(),$("#menus").animate({scrollTop:500},300)')
$('.backc,.ktext,#logof').on('input',function(){a=$(this),b=a.val(),a.is('.ktext')?$('.btext').html(b||'预览'):(a.is('#logof')?C[1][9]=(b||'Google'):(c=b.match(/[a-f0-9]{6}/gi),c&&($('.backc').val(C[2][2]=d='#'+c).eq(0).css('background',d))),style())})
$('#submit').click(function(){a=$('#input').val();if(a)run(a);return !1}).longPress('$("#engine,#bar").slideToggle();for(var a=$("#engine li"),b=0;b<6;b++)a.eq(b).css(a.eq(b).attr("msg")!=C[3][5]?({"color":"#888","text-shadow":""}):({"color":"","text-shadow":"0 0 1px #555"}))')
$('.kicon').click(function(){a=$('.bicon');if($(this).attr('type')){$(this).on('input',function(){c='img/jz.gif';i.test(b=$(this).val())?a.attr('src',b):a.attr('src')!=c&&a.attr('src',c)})}else{$('#xfile').click().change(function(){$('.kicon').eq(0).val($(this).val()),b=new FileReader(),b.readAsDataURL(this.files[0]),b.onload=function(){a.attr('src',this.result)}})}})
$('.logop,.backp').click(function(){var a=$(this).is('.backp');if($(this).attr('type')){$(this).on('input',function(){i.test(b=$(this).val())&&(a?C[2][3]=b:C[1][10]=b,style())})}else{$(a?'#bfile':'#pfile').click().change(function(){$(a?'.backp':'.logop').eq(0).val($(this).val()),b=new FileReader(),b.readAsDataURL(this.files[0]),b.onload=function(){c=this.result,a?C[2][3]=c:C[1][10]=c,style()}})}})
$('#input').on('input focus',function(){$('#bar').stop().animate({'top':Math.abs(orientation)==90?'78%':C[3][1]+'px'},300),E=0,a=$(this).val(),$('#book').hide(),$('#clear').css('display',a?'block':K),a?clearTimeout(b):$('#suglist').html(K),b=setTimeout('getdata(a)',C[3][2])}).blur(function(){$(this).val()||(E=1,$('#bar').stop().animate({'top':'30%'},300,function(){E&&$('#book').show()}))})
$('.byes').click(function(){a=$('.ktext').val(),b=$('.khttp').val(),c=$('.bicon').attr('src');(a&&b&&c!='img/jz.gif')?(b=p.test(b)||!u.test(b)?b:'http://'+b,d='<div class="sc"></div><div class="bq" style="background-image:url('+c+')" msg="'+b+'"></div><p>'+a+'</p>',cat==99?(B.push([a,b,c]),$('.mark').before('<li>'+d+'</li>')):(B.splice(cat,1,[a,b,c]),$('#book li').eq(cat).html(d)),L.setItem('bok',JSON.stringify(B)),$('.bno').click(),mark()):alert('书签不完整\nヾ(°ｰ°ヾ)^?啊咧？')})
$('#menu input,#custom').change(function(){a=$(this),b=a.val(),c=1;a.is('#fontc0')?C[1][4]=b:a.is('#fontc1')?C[1][5]=b:a.is('#fonts')?C[1][6]=(b||24):a.is('#logor')?C[1][7]=(b||0):a.is('#logos')?C[1][8]=(b||120):a.is('#backt')?C[2][4]=(b||0):a.is('#backl')?C[2][5]=(b||0):a.is('#backw')?C[2][6]=(b||100):a.is('#backb')?C[2][7]=(b||0):a.is('#barh')?C[3][1]=(b||400):a.is('#bart')?C[3][2]=(b||300):a.is('#barp')?C[3][3]=(b||'What'):a.is('#bars')?C[3][4]=(b||'Go'):a.is('#bookr')?C[4][1]=(b||0):a.is('#bookc')?C[4][2]=b:a.is('#bookn')?C[4][3]=(b||5):a.is('#custom')?C[2][9]=b:c=0;a.attr('type')=='color'&&a.css('background',b);c&&style()})
$('.time,#engine li').longPress(function(){if(E)E=F=0,$("#menu")[0].reset(),$(".timeb,.logof,#logof,#fontc1,#logop,.logop,.backp,#about,#zz,.wqy").hide(),$("#menu").slideDown(),$("#engine,#book,#bar").slideUp(),$(".logo").html((b=C[1],a=b[1])),$(a=="时间"?".logof,.timeb":a=="文字"?".logof,#logof":"#logop").show(),$(".timeb o").html(b[2]?"显示":"隐藏"),$(".fontc").html(b[3]?($("#fontc1").show(),"渐变"):"单色"),$("#fontc0").val(b[4]).css('background',b[4]),$("#fontc1").val(b[5]).css('background',b[5]),$("#fonts").val(b[6]),$("#logor").val(b[7]),$("#logos").val(b[8]),$("#logof").val(b[9]),$(".logop").eq(a=i.test(b[10])?1:0).val(a?b[10]:"图片为base64编码").show().nextAll("o").html(a?"路径":"图片"),$("#back").html((b=C[2],b[1]?"图片":"颜色")),$(".backc").val(b[2]).eq(0).css('background',b[2]),$(".backp").eq(a=i.test(b[3])?1:0).val(a?b[3]:"图片为base64编码").show().nextAll("o").html(a?"路径":"图片"),$("#backt").val(b[4]),$("#backl").val(b[5]),$("#backw").val(b[6]),$("#backb").val(b[7]),$(".qh").html(b[8]?"显示":"隐藏"),$("#custom").val(b[9]),$("#barh").val((b=C[3],b[1])),$("#bart").val(b[2]),$("#barp").val(b[3]),$("#bars").val(b[4]),$("#bookr").val((b=C[4],b[1])),$("#bookc").val(b[2]).css('background',b[2]),$("#bookn").val(b[3])})
function getdata(a){$.ajax({url:'http://suggestion.baidu.com/su',type:'GET',dataType:'jsonp',data:{wd:a,cb:'su'}})}
function su(a){for(var b=a.s,c=K,d=$('#suglist'),e=b.length;e>0;e--)c+='<li><v>'+b[e-1]+'</v><b>╋</b></li>';d.html(c)}
function run(a){$('#clear').attr('style',K),$('#suglist').html(K),$('#input').val(K).blur(),open(p.test(a)?a:u.test(a)?'http://'+a:C[3][5]+a)}
function num(a,b,c){d=$(a).val(),e=d.length,$(a).val(d.substring(0,b>9?(e<2&&/[a-f0-9#]/i.test(d)||/[a-f0-9]+$/ig.test(d)?(/^#/.test(d)?7:6):e-1):b==9&&e<2&&/[-\d]/.test(d)||/\d+$/g.test(d)?(/^0/.test(d)?c:(b<9?b:/^-/.test(d)?4:3)):e-1))}
function mark(){$('.bq').longPress(function(){if(D)D=E=0,$(".sc").fadeIn().css("margin-left",(a=$("#book li").width(),a>64?a/2+10:a-20)+"px"),$(".bq").length<20&&$(".mark").show()})};mark()
function style(){var a=C[1],b=C[2],c=C[4],d=$('#book').width()/c[3],e=d>64,f=e?40:d*5/8;T=0,$('.back').remove(),$('#input').attr('placeholder',C[3][3]),$('#submit').val(C[3][4]),$('.custom').html(b[9]),$('style').html('.lgo{'+(/图片/.test(a[1])?($('.lgo').html('<img src="'+a[10]+'" style="background-size:cover;border-radius:'+a[7]+'px;width:'+a[8]+'px">'),K):(a[3]?'-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-image:-webkit-linear-gradient(left,'+a[4]+','+a[5]+')':'color:'+a[4])+';font-size:'+a[6]+'px'+(/时间/.test(a[1])?(T=1,a[2]&&$('.lgo').before('<p class="lgo back" style="opacity:0.2;position:absolute">88:88:88</p>'),';font-family:a;height:1em'):($('.lgo').html(a[9]),K)))+'}body,body:after{background:'+b[2]+' url('+(b[1]&&b[3])+') '+b[5]+'px '+b[4]+'px / '+b[6]+'% no-repeat}body:after{content:"";display:block;z-index:-1;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-filter:blur('+b[7]+'px)}.sx{display:'+(b[8]?'block':'none')+'}#book li{width:'+d+'px;height:'+(e?64:d)+'px}.bq,.bicon{border-radius:'+c[1]+'px}.bq,.tj{width:'+f+'px;height:'+f+'px}#book p,.btext{color:'+c[2]+';font-size:'+(e?12:d*0.2)+'px}@media all and (orientation:landscape){#book li{width:12.5%;height:64px}.tj,.bq{width:40px;height:40px}#book p,.btext{font-size:12px}}')};style()
$(function(){var x,y,d,w,h,p,left,top,f,m,a=$('#book')[0],b=0;
a.addEventListener('touchstart',function(e){var c=$(e.target).parents('li');if(!$(e.target).is('.bq')||D||c.is('.mark')||$('#bookmark').attr('style')||b)return;d=c,m=d.index(),w=d.width(),h=d.height(),p=d.offset(),left=p.left,top=p.top;d.css({'width':w,'height':h,'position':'fixed',opacity:.8,left:left,top:top}).before('<li class="bok"></li>'),f=$('.bok');var g=e.targetTouches[0];x=g.pageX,y=g.pageY,w/=2,h/=2,b=1},{passive:true});
a.addEventListener('touchmove',function(e){if(b){var g=e.targetTouches[0],l=left+g.pageX-x,t=top+g.pageY-y;d.css({'left':l,'top':t}),l+=w,t+=h,$(a).children().not(d).not(f).not('.mark').each(function(i){var i=$(this),p=i.offset();if(p.left<l&&l<p.left+i.width()&&p.top<t&&t<p.top+i.height())return i.next('.bok').length?f.insertBefore(this):f.insertAfter(this),!1})}},{passive:true});
a.addEventListener('touchend',function(){if(b){var p=f.offset();d.animate({'left':p.left,'top':p.top},200,function(){if($('.bok').length){d.removeAttr('style'),f.replaceWith(d),n=d.index(),b=0;B.splice(n+(m-n<0&&1),0,B[m]),B.splice(m+(m-n>0&&1),1),L.setItem('bok',JSON.stringify(B))}})}},{passive:true})
$(document).click(function(e){var a=$(e.target),b=a.parent(),c=a.parents(),d=a.html()
if($('.mark').attr('style')&&!a.is('.sc'))$('.sc').css('-webkit-animation','shensuo1 0.3s'),$('.tj').animate({'marginTop':50,'opacity':0},300,function(){$('.mark,.sc').removeAttr('style'),$(this).css({'margin-top':K,'opacity':K})}),a.is('.tj')||a.is('.bq')?($('#bookmark,#bar').slideToggle(),$('#mark')[0].reset(),$('.kicon').hide(),a.is('.bq')?($('.bbox p').html('编辑书签'),cat=b.index()-1,c=B[cat],$('.btext').html(c[0]),$('.ktext').val(c[0]),$('.khttp').val(c[1]),$('.bicon').attr('src',c[2]),$('#mark o').html(i.test(c[2])?($('.kicon').eq(1).val(c[2]).show(),'路径'):($('.kicon').eq(0).val('图片为base64编码').show(),'图片'))):($('.bbox p').html('添加书签'),cat=99,$('.btext').html('预览'),$('.bicon').attr('src','img/jz.gif'),$('#mark o').html('图片'),$('.kicon').eq(0).show())):D=E=1
if(a.is('.logo'))a.html(C[1][1]=d=='时间'?(e='#logof,.timeb','文字'):d=='文字'?(e='.logof,#logop,#logof','图片'):(e='#logop,.logof,.timeb','时间')),$(e).toggle(),style()
if(a.is('.sc'))a.remove(),b.find('div').animate({'marginTop':50,'opacity':0},300,function(){b.remove()}),B.splice(b.index(),1),L.setItem('bok',JSON.stringify(B))
if(a.is('.set'))$(c.is('#mark')?($('.bicon').attr('src','img/jz.gif'),'.kicon'):c.is('#logop')?'.logop':'.backp').toggle().val(K),a.html(d=='图片'?'路径':'图片')
if(a.is('#engine li'))C[3][5]=a.attr('msg'),$('#engine,#bar').slideToggle(),L.setItem('mnu',JSON.stringify(C))
if(a.is('.fontc'))a.html(d=='单色'?(e=1,'渐变'):(e=0,'单色')),$('#fontc1').toggle(),C[1][3]=e,style()
if(a.is('.mno'))$('#menu,#bar,#book').slideToggle(),!E&&(E=1,C=JSON.parse(L.mnu),style())
if(a.is('.about'))F=F?0:1,$('#about').toggle(),$('#menus').animate({scrollTop:(F?500:0)},300)
if(a.is('.bno'))$('#bar,#bookmark').slideToggle(function(){$(this).attr('style',K)}),D=E=1
if(c.is('#suglist'))e=a.closest('li').find('v').text(),a.is('b')?$('#input').val(e).focus():run(e)
if(a.is('.timeb o'))a.html(d=='隐藏'?(e=1,'显示'):(e=0,'隐藏')),C[1][2]=e,style()
if(a.is('#back'))a.html(d=='图片'?(e=0,'颜色'):(e=1,'图片')),C[2][1]=e,style()
if(a.is('.qh'))a.html(d=='隐藏'?(e=1,'显示'):(e=0,'隐藏')),C[2][8]=e,style()
if(a.is('.myes'))L.setItem('mnu',JSON.stringify(C)),$('.mno').click(),E=1
if(a.is('#clear'))$('#input').val(K).focus(),$('#bar')[0].reset()
if(a.is('.lgo *')&&E||a.is('.lgo')&&E)self.location='folder://'
if(a.is('.wyes'))L.removeItem('mnu'),location.reload()
if(a.is('.bq')&&D)open(a.attr('msg'))
if(a.is('.wno'))$('.wqy').slideUp()
if(a.is('.sx'))location.reload()
})})